# EdDSA Consumer Example - Local Development
#
# For local development with inline public key (no service bindings).
# Service bindings only work in deployed Workers - use wrangler.toml [[services]] for production.
#
# SETUP INSTRUCTIONS:
#
# 1. Generate a keypair (from root directory):
#    npx flarelette-jwt-keygen --kid=ed25519-2025-01 > keys.json
#
# 2. Copy the "publicJwk" from keys.json to GW_ED25519_PUBLIC below
#    (paste the entire JSON object as a single line, no newlines)
#
# 3. Start local dev server:
#    wrangler dev
#
# 4. Get a token from the producer (running separately) and test:
#    curl -H "Authorization: Bearer <token>" http://localhost:8787/whoami

# Reference to the environment variable containing the public key
JWT_PUBLIC_JWK_NAME=GW_ED25519_PUBLIC

# The actual public key JWK (paste from keys.json "publicJwk" field)
# Example format: {"kty":"OKP","crv":"Ed25519","x":"base64url-encoded-public-key","kid":"ed25519-2025-01"}
GW_ED25519_PUBLIC={"kty":"OKP","crv":"Ed25519","x":"REPLACE_WITH_YOUR_PUBLIC_KEY","kid":"ed25519-2025-01"}

# JWT validation settings (must match producer)
JWT_ISS=https://gateway.internal
JWT_AUD=api.internal

# Optional: Restrict to specific key thumbprints for additional security
# Generate thumbprints with: npx jose jwk thumbprint keys.json
# JWT_ALLOWED_THUMBPRINTS=thumb1,thumb2
